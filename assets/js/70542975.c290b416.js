"use strict";(self.webpackChunkzio_site=self.webpackChunkzio_site||[]).push([[25669],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>h});var r=n(67294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var c=r.createContext({}),l=function(e){var t=r.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},p=function(e){var t=l(e.components);return r.createElement(c.Provider,{value:t},e.children)},m="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},d=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,i=e.originalType,c=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),m=l(n),d=a,h=m["".concat(c,".").concat(d)]||m[d]||u[d]||i;return n?r.createElement(h,o(o({ref:t},p),{},{components:n})):r.createElement(h,o({ref:t},p))}));function h(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=n.length,o=new Array(i);o[0]=d;var s={};for(var c in t)hasOwnProperty.call(t,c)&&(s[c]=t[c]);s.originalType=e,s[m]="string"==typeof e?e:a,o[1]=s;for(var l=2;l<i;l++)o[l]=n[l];return r.createElement.apply(null,o)}return r.createElement.apply(null,n)}d.displayName="MDXCreateElement"},56255:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>o,default:()=>u,frontMatter:()=>i,metadata:()=>s,toc:()=>l});var r=n(87462),a=(n(67294),n(3905));const i={id:"index",title:"Metrics"},o=void 0,s={unversionedId:"zio-metrics-connectors/metrics/index",id:"zio-metrics-connectors/metrics/index",title:"Metrics",description:"ZIO ZMX enables the instrumentation of any ZIO based application with specialized aspects. The type of the original ZIO effect will not change by adding on or more aspects to it.",source:"@site/docs/zio-metrics-connectors/metrics/index.md",sourceDirName:"zio-metrics-connectors/metrics",slug:"/zio-metrics-connectors/metrics/",permalink:"/zio-metrics-connectors/metrics/",draft:!1,editUrl:"https://github.com/zio/zio/edit/series/2.x/docs/zio-metrics-connectors/metrics/index.md",tags:[],version:"current",frontMatter:{id:"index",title:"Metrics"},sidebar:"ecosystem-sidebar",previous:{title:"Getting Started",permalink:"/zio-metrics-connectors/getting-started"},next:{title:"ZMX Metric Reference",permalink:"/zio-metrics-connectors/metrics/zmx-metric-reference"}},c={},l=[{value:"General Metric architecture",id:"general-metric-architecture",level:2}],p={toc:l},m="wrapper";function u(e){let{components:t,...n}=e;return(0,a.kt)(m,(0,r.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"ZIO ZMX enables the instrumentation of any ZIO based application with specialized aspects. The type of the original ZIO effect will not change by adding on or more aspects to it. "),(0,a.kt)("p",null,"Whenever an instrumented effect executes, all of the aspects will be executed as well and each of the\naspects will capture some data of interest and update some ZMX internal state. Which data will be captured and how it can be used later on is dependant on the metric type associated with the aspect. "),(0,a.kt)("p",null,"Metrics are normally captured to be displayed in an application like ",(0,a.kt)("a",{parentName:"p",href:"https://grafana.com/"},"Grafana")," or a cloud based platform like ",(0,a.kt)("a",{parentName:"p",href:"https://docs.datadoghq.com/"},"DatadogHQ"),"\nor ",(0,a.kt)("a",{parentName:"p",href:"https://newrelic.com"},"NewRelic"),".\nIn order to support such a range of different platforms, the metric state is kept in an internal data structure optimized to update the state as efficiently as possible\nand the data required by one or more of the platforms is generated only when it is required. "),(0,a.kt)("p",null,"This also allows us to provide a ZMX web client (in one of the next minor releases) out of the box to visualize the metrics in the development phase before the decision\nfor a metric platform has been made or in cases when the platform might not be feasible to use in development. "),(0,a.kt)("p",null,"For a sneak preview, building a ZMX metrics client was the topic of two live coding sessions on Twitch TV:\nBuilding a ZMX metrics client ",(0,a.kt)("a",{parentName:"p",href:"https://www.twitch.tv/kitlangton/video/1038831171"},"Part I")," and ",(0,a.kt)("a",{parentName:"p",href:"https://www.twitch.tv/kitlangton/video/1038926026"},"Part II")),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"Changing the targeted reporting back end will have no impact on the application at all. Once instrumented properly, that reporting back end decision will happen ",(0,a.kt)("strong",{parentName:"p"},"at the end of the world"),"\nin the ZIO applications mainline by injecting one or more of the available reporting clients.")),(0,a.kt)("p",null,"Currently ZMX provides mappings to ",(0,a.kt)("a",{parentName:"p",href:"https://docs.datadoghq.com/"},"StatsD")," and ",(0,a.kt)("a",{parentName:"p",href:"https://prometheus.io/"},"Prometheus")," out of the box. "),(0,a.kt)("h2",{id:"general-metric-architecture"},"General Metric architecture"),(0,a.kt)("p",null,"All metrics in ZMX have a name of type ",(0,a.kt)("inlineCode",{parentName:"p"},"String")," which may be augmented by zero or many ",(0,a.kt)("inlineCode",{parentName:"p"},"Label"),"s. A ",(0,a.kt)("inlineCode",{parentName:"p"},"Label")," is simply a key/value pair to further qualify the name.\nThe distinction is made, because some reporting platforms support tags as well and provide certain aggregation mechanisms for them. "),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"For example, think of a counter that simply counts how often a particular service has been invoked. If the application is deployed across several hosts, we might\nmodel our counter with a name ",(0,a.kt)("inlineCode",{parentName:"p"},"myService"),"and an additional label ",(0,a.kt)("inlineCode",{parentName:"p"},"(host, ${hostname})"),". With such a definition we would see the number of executions for each host,\nbut we could also create a query in Grafana or DatadogHQ to visualize the aggregated value over all hosts. Using more than one label would allow to create visualizations\nacross any combination of the labels. ")),(0,a.kt)("p",null,"An important aspect of metric aspects is that they ",(0,a.kt)("em",{parentName:"p"},"understand")," values of a certain type. For example, a Gauge understands ",(0,a.kt)("inlineCode",{parentName:"p"},"Double")," values to manipulate the current\nvalue within the gauge. This implies, that for effects ",(0,a.kt)("inlineCode",{parentName:"p"},"ZIO[R, E, A]")," where ",(0,a.kt)("inlineCode",{parentName:"p"},"A")," can not be assigned to a ",(0,a.kt)("inlineCode",{parentName:"p"},"Double")," we have to provide a mapping function ",(0,a.kt)("inlineCode",{parentName:"p"},"A => Double"),"\nso that we can derive the measured value from the effect\xb4s result. "),(0,a.kt)("p",null,"Finally, more complex metrics might require additional information to specify them completely. For example, within a ",(0,a.kt)("a",{parentName:"p",href:"metrics/index.md#histograms"},"histogram")," we need to specify the\nbuckets the observed values shall be counted in. "),(0,a.kt)("p",null,"Please refer to "),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"/zio-metrics-connectors/metrics/zmx-metric-reference"},"Metrics Reference")," for more information on the metrics currently supported"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"/zio-metrics-connectors/metrics/prometheus-client"},"Prometheus Client")," to learn more about the mapping from ZMX to Prometheus"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"/zio-metrics-connectors/metrics/statsd-client"},"StatsD Client")," to learn more about the mapping from ZMX to StatsD"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"/zio-metrics-connectors/metrics/metrics_datadog"},"DataDog Client")," to learn more about the mapping from ZMX to DataDog")))}u.isMDXComponent=!0}}]);